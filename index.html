<section id="dashboard" style="display:none;">
<h2>Panel Administrativo</h2>
<div class="container">

<!-- Tabs -->
<div style="width:100%; display:flex; gap:10px; margin-bottom:10px;">
<button onclick="abrirTab('usuarios-tab')">Usuarios</button>
<button onclick="abrirTab('gerencias-tab')">Gerencias</button>
<button onclick="abrirTab('departamentos-tab')">Departamentos</button>
<button onclick="abrirTab('solicitudes-tab')">Solicitudes</button>
<button onclick="abrirTab('nueva-solicitud-tab')">Nueva Solicitud</button>
</div>

<!-- Tab Usuarios -->
<div id="usuarios-tab" class="tab" style="display:block;">
<!-- aquí va todo el HTML de usuarios que te pasé antes -->
</div>

<!-- Tab Gerencias -->
<div id="gerencias-tab" class="tab" style="display:none;">
<!-- HTML de gerencias -->
</div>

<!-- Tab Departamentos -->
<div id="departamentos-tab" class="tab" style="display:none;">
<!-- HTML de departamentos -->
</div>

<!-- Tab Solicitudes -->
<div id="solicitudes-tab" class="tab" style="display:none;">
<!-- HTML para listar solicitudes -->
</div>

<!-- Tab Nueva Solicitud -->
<div id="nueva-solicitud-tab" class="tab" style="display:none;">
<h3>Crear Nueva Solicitud</h3>
<input type="text" id="solNombre" placeholder="Nombre del documento">
<select id="solTipo">
<option value="Procedimiento">Procedimiento</option>
<option value="Guía">Guía</option>
<option value="Instructivo">Instructivo</option>
<option value="Manual">Manual</option>
<option value="Formato">Formato</option>
</select>
<select id="solAccion">
<option value="Creación">Creación</option>
<option value="Modificación">Modificación</option>
<option value="Inactivación">Inactivación</option>
</select>
<select id="solGerencia">
<option value="">Seleccione Gerencia</option>
</select>
<select id="solDepartamento">
<option value="">Seleccione Departamento</option>
</select>
<input type="text" id="solMotivo" placeholder="Motivo">
<input type="text" id="solUltimaVersion" placeholder="Última versión (solo si Modificación/Inactivación)">
<input type="text" id="solFechaUltima" placeholder="Fecha última versión">
<input type="text" id="solCodigo" placeholder="Codificación del documento">
<button onclick="crearSolicitud()">Crear Solicitud</button>
</div>
</div>

<script>
// Función Tabs
function abrirTab(tabId){
    const tabs = document.querySelectorAll(".tab");
    tabs.forEach(t=>t.style.display="none");
    document.getElementById(tabId).style.display="block";
}

// Cargar gerencias y departamentos en formulario de solicitud
async function cargarGerenciasSolicitudes(){
    const snapshot = await db.collection("gerencias").get();
    const gerSelect = document.getElementById("solGerencia");
    gerSelect.innerHTML='<option value="">Seleccione Gerencia</option>';
    snapshot.forEach(doc=>{
        const data = doc.data();
        gerSelect.innerHTML += `<option value="${data.nombre}">${data.nombre}</option>`;
    });
}
async function cargarDepartamentosSolicitudes(){
    const snapshot = await db.collection("departamentos").get();
    const depSelect = document.getElementById("solDepartamento");
    depSelect.innerHTML='<option value="">Seleccione Departamento</option>';
    snapshot.forEach(doc=>{
        const data = doc.data();
        depSelect.innerHTML += `<option value="${data.nombre}">${data.nombre}</option>`;
    });
}
cargarGerenciasSolicitudes();
cargarDepartamentosSolicitudes();

// Crear Solicitud
async function crearSolicitud(){
    const solicitud = {
        nombreDocumento: document.getElementById("solNombre").value,
        tipo: document.getElementById("solTipo").value,
        accion: document.getElementById("solAccion").value,
        gerencia: document.getElementById("solGerencia").value,
        departamento: document.getElementById("solDepartamento").value,
        motivo: document.getElementById("solMotivo").value,
        ultimaVersion: document.getElementById("solUltimaVersion").value,
        fechaUltima: document.getElementById("solFechaUltima").value,
        codificacion: document.getElementById("solCodigo").value,
        estado: "Pendiente",
        usuario: "Admin"
    };
    await db.collection("solicitudes").add(solicitud);
    alert("Solicitud creada");
    cargarSolicitudes(); // refresca lista
}
</script>